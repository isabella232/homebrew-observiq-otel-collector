# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class ObserviqOtelCollectorAT120 < Formula
  desc "observIQ's distribution of the OpenTelemetry Collector"
  homepage "https://github.com/observIQ/observiq-otel-collector"
  version "1.2.0"
  license "Apache 2.0"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/observIQ/observiq-otel-collector/releases/download/v1.2.0/observiq-otel-collector-v1.2.0-darwin-amd64.tar.gz", :using => CurlDownloadStrategy
      sha256 "37d7d70c787d5affd64a01dad94d427de622e17efa90f9d94786d518f0722f55"

      def install
        bin.install "observiq-otel-collector"
        prefix.install "LICENSE", "VERSION.txt", "logging.yaml"
        etc.install "config.yaml" => "observiq_config.yaml"
        prefix.install_symlink etc/"observiq_config.yaml" => "config.yaml"
        prefix.install Dir["plugins"]
        lib.install "opentelemetry-java-contrib-jmx-metrics.jar"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/observIQ/observiq-otel-collector/releases/download/v1.2.0/observiq-otel-collector-v1.2.0-darwin-arm64.tar.gz", :using => CurlDownloadStrategy
      sha256 "5605857267579886fffe0c007738ff08a6157989bca66c8200dd6bff4114f5fc"

      def install
        bin.install "observiq-otel-collector"
        prefix.install "LICENSE", "VERSION.txt", "logging.yaml"
        etc.install "config.yaml" => "observiq_config.yaml"
        prefix.install_symlink etc/"observiq_config.yaml" => "config.yaml"
        prefix.install Dir["plugins"]
        lib.install "opentelemetry-java-contrib-jmx-metrics.jar"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/observIQ/observiq-otel-collector/releases/download/v1.2.0/observiq-otel-collector-v1.2.0-linux-amd64.tar.gz", :using => CurlDownloadStrategy
      sha256 "756979d52d258d1cff079012c789efc5e6ac0b507a774b7bd3fd9c8979e475e0"

      def install
        bin.install "observiq-otel-collector"
        prefix.install "LICENSE", "VERSION.txt", "logging.yaml"
        etc.install "config.yaml" => "observiq_config.yaml"
        prefix.install_symlink etc/"observiq_config.yaml" => "config.yaml"
        prefix.install Dir["plugins"]
        lib.install "opentelemetry-java-contrib-jmx-metrics.jar"
      end
    end
    if Hardware::CPU.arm? && !Hardware::CPU.is_64_bit?
      url "https://github.com/observIQ/observiq-otel-collector/releases/download/v1.2.0/observiq-otel-collector-v1.2.0-linux-arm.tar.gz", :using => CurlDownloadStrategy
      sha256 "fbd449e5aa15da039a7476d7e00766e63144c093755470e6b611ff3f7dca629d"

      def install
        bin.install "observiq-otel-collector"
        prefix.install "LICENSE", "VERSION.txt", "logging.yaml"
        etc.install "config.yaml" => "observiq_config.yaml"
        prefix.install_symlink etc/"observiq_config.yaml" => "config.yaml"
        prefix.install Dir["plugins"]
        lib.install "opentelemetry-java-contrib-jmx-metrics.jar"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/observIQ/observiq-otel-collector/releases/download/v1.2.0/observiq-otel-collector-v1.2.0-linux-arm64.tar.gz", :using => CurlDownloadStrategy
      sha256 "81bfaca65631e214859e544a857bcf21b2195b455141aac092f8ef3c4cd12888"

      def install
        bin.install "observiq-otel-collector"
        prefix.install "LICENSE", "VERSION.txt", "logging.yaml"
        etc.install "config.yaml" => "observiq_config.yaml"
        prefix.install_symlink etc/"observiq_config.yaml" => "config.yaml"
        prefix.install Dir["plugins"]
        lib.install "opentelemetry-java-contrib-jmx-metrics.jar"
      end
    end
  end

  def caveats; <<~EOS
    ****************************************************************
    The configuration file that is run by the service is located at #{prefix}/config.yaml.

    If you are configuring a logreceiver the plugin directory is located at #{prefix}/plugins.
    ****************************************************************

    ****************************************************************
    Below are services commands to run to manage the collector service.
    If you wish to run the collector at boot prefix these commands with sudo
    otherwise the service will run at login.

    To start the collector service run:

      brew services start observiq/observiq-otel-collector/observiq-otel-collector@1.2.0

    To stop the collector service run:

      brew services stop observiq/observiq-otel-collector/observiq-otel-collector@1.2.0

    To restart the collector service run:

      brew services restart observiq/observiq-otel-collector/observiq-otel-collector@1.2.0
    ****************************************************************

    ****************************************************************
    To uninstall the collector and its dependencies run the following commands:

        brew services stop observiq/observiq-otel-collector/observiq-otel-collector@1.2.0
        brew uninstall observiq/observiq-otel-collector/observiq-otel-collector@1.2.0

        # If you moved the opentelemetry-java-contrib-jmx-metrics.jar
        sudo rm /opt/opentelemetry-java-contrib-jmx-metrics.jar

    ****************************************************************
  EOS
  end

  service do
    run [opt_bin/"observiq-otel-collector", "--config", opt_prefix/"config.yaml", "--logging", opt_prefix/"logging.yaml", "--manager", opt_prefix/"manager.yaml"]
    environment_variables OIQ_OTEL_COLLECTOR_HOME: opt_prefix
    keep_alive true
  end
end
